<script>
    // --- CONFIGURATION ---
    const TOTAL_PHOTOS = 200; 
    const START_DATE = new Date("2025-02-05T22:00:00"); // Your actual anniversary
    
    // THE MAGIC SWITCH: Date when "Anniversary Mode" turns off
    const SPECIAL_EFFECT_END = new Date("2026-02-07T23:59:59"); 

    // 1. DYNAMIC PHOTO LOADER
    const gallery = document.getElementById('gallery-loader');
    for (let i = 1; i <= TOTAL_PHOTOS; i++) {
      const img = document.createElement('img');
      img.src = `Foto(${i}).jpg`; // Make sure this matches your file naming!
      img.alt = "Memory " + i;
      img.loading = "lazy";
      img.onerror = function() { this.style.display = 'none'; };
      gallery.appendChild(img);
    }

    // 2. SMART GREETING & TIMER
    function updateContent() {
      const now = new Date();
      const diff = now - START_DATE;
      const isSpecialMode = now <= SPECIAL_EFFECT_END;

      // Update Title based on date
      const titleElement = document.querySelector("h1");
      const subTextElement = document.querySelector(".main-card p");
      const letterBtn = document.querySelector(".btn-letter");

      if (isSpecialMode) {
        if (titleElement.innerText !== "Happy 1st Anniversary!") {
            titleElement.innerText = "Happy 1st Anniversary!";
            subTextElement.innerText = "Celebrating our best year yet.";
            letterBtn.style.display = "inline-block"; // Show letter
        }
      } else {
        // After Feb 7th, it reverts to this:
        if (titleElement.innerText !== "Together Forever") {
            titleElement.innerText = "Together Forever";
            subTextElement.innerText = "Every day with you is a gift.";
            letterBtn.style.display = "none"; // Hide letter (optional)
        }
      }

      // Timer Logic
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((diff / (1000 * 60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);

      document.getElementById("countdown").innerHTML = 
        `We've been in love for:<br>
        ${days} Days, ${hours} Hours, ${minutes} Minutes, ${seconds} Seconds`;
    }
    
    // Run immediately and then every second
    updateContent();
    setInterval(updateContent, 1000);

    // 3. MUSIC PLAYER
    const music = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicBtn");
    let isPlaying = false;

    function toggleMusic() {
      if (isPlaying) {
        music.pause();
        musicBtn.innerText = "ðŸŽµ Play Our Song";
      } else {
        music.play();
        musicBtn.innerText = "â¸ Pause Song";
      }
      isPlaying = !isPlaying;
    }

    // 4. LETTER MODAL
    const modal = document.getElementById("letterModal");
    const letterBox = document.querySelector(".letter-content");

    function openLetter() {
      modal.style.display = "flex";
      setTimeout(() => {
        modal.style.opacity = "1";
        letterBox.style.transform = "translateY(0)";
      }, 10);
    }

    function closeLetter() {
      modal.style.opacity = "0";
      letterBox.style.transform = "translateY(50px)";
      setTimeout(() => {
        modal.style.display = "none";
      }, 500);
    }

    // 5. FLOATING HEARTS (Only run during special mode!)
    function createHeart() {
      const now = new Date();
      // Stop creating hearts after the special date to save battery/clean up look
      if (now > SPECIAL_EFFECT_END) return; 

      const heart = document.createElement("div");
      heart.classList.add("heart");
      heart.innerText = Math.random() > 0.5 ? "â¤ï¸" : "âœ¨";
      heart.style.left = Math.random() * 100 + "vw";
      heart.style.animationDuration = Math.random() * 3 + 3 + "s";
      document.querySelector(".hearts-container").appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }
    setInterval(createHeart, 600);

</script>
